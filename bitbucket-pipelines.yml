image: node:22

definitions:
  caches:
    yarn: .yarn/cache

pipelines:
  pull-requests:
    '**':
      - step:
          name: 🧹 Lint all apps
          caches:
            - yarn
          script:
            - corepack enable
            - yarn install --immutable
            - npx nx run-many --target=lint --projects=pnt,partners,tms,publishing

      - step:
          name: 🛠️ Build all apps
          caches:
            - yarn
          script:
            - corepack enable
            - yarn install --immutable
            - npx nx run-many --target=build --projects=pnt,partners,tms,publishing
